# CLAUDE.md - 프로젝트 작업 원칙

## 🔴 하드웨어 통신 작업 원칙

### 1. 절대 건드리지 말 것
- 프로토콜 명령어 (hex 값)
- 바이트 순서 (엔디안)
- 타이밍/딜레이
- 패킷 구조

### 2. 작업 순서
1. **먼저 기존 동작 코드 그대로 실행**
2. **동작 확인 후 필요한 부분만 수정**
3. **수정 시 한 번에 하나씩만**
4. **각 수정 후 바로 테스트**

### 3. 금지 사항
- ❌ "최적화"라는 이름으로 구조 바꾸기
- ❌ 엔디안 "추측"하기
- ❌ 복잡한 클래스 구조 만들기
- ❌ 프로토콜 "개선"하기
- ❌ 동작하는 코드를 처음부터 다시 작성하기
- ❌ 에러처리 코드 등은 나중에 추가하기 (먼저 간단하게)

### 4. 필수 확인
- ✅ 기존 코드에서 실제 hex 값 확인
- ✅ 동작하는 코드 먼저 복사
- ✅ 최소한의 수정만
- ✅ 하드웨어 통신은 항상 "있는 그대로" 사용

## 핵심 원칙
**"동작하는 코드를 먼저 그대로 쓰고, 검증 후 최소한만 수정"**

## 프로젝트 정보

### 디바이스 통신 포트
- PIC24 제어: `/dev/ttyS0` (115200)
- 카메라: `/dev/ttyUSB0` (115200)
- BMS: `/dev/ttyUSB1` (9600)
- 센서들: I2C 버스

### 카메라 프로토콜 (Spinel SC20MPF)
- 모든 값은 Little Endian
- 스냅샷 명령: `90 EB 01 40 04 00 00 02 05 05 C1 C2`
- 데이터 읽기: `90 EB 01 48 06 00 [주소 4바이트 LE] 00 03 C1 C2`
- 패킷 크기: 768바이트 (0x00 0x03으로 표현)

### 테스트 명령어
- 린트: `npm run lint`
- 타입체크: `npm run typecheck`

### 커밋 원칙
- 커밋 메시지는 한 줄로 간단하게
- 무슨 일을 했는지만 명시
- 예: "Update camera module", "Fix serial communication"